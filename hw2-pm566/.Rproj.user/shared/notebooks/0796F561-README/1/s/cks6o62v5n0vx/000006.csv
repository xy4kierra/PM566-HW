"0","# Create average"
"0","pm25_avg <- "
"0","  chs %>%"
"0","  group_by(townname) %>%"
"0","  summarise(pm25_avg = mean(pm25_mass),"
"0","            lat = mean(lat),"
"0","            lon = mean(lon))"
"0","# Generating a color palette"
"0","pm.pal <- colorNumeric(c('darkgreen','goldenrod','brown'), domain = pm25_avg$pm25_avg)"
"0","pm25.map <- leaflet(pm25_avg) %>% "
"0","  "
"0","# The looks of the Map"
"0","addProviderTiles('CartoDB.Positron') %>% "
"0",""
"0","# Some circles"
"0","addCircles("
"0","    lat = ~lat, lng=~lon,"
"0","    label = ~paste0(round(pm25_avg,2), ' C'), color = ~ pm.pal(pm25_avg),"
"0","    opacity = 1, fillOpacity = 1, radius = 500) %>%"
"0",""
"0","# And a pretty legend"
"0","addLegend('bottomleft', pal=pm.pal, values=pm25_avg$pm25_avg,"
"0","          title='PM2.5 Mass, C', opacity=1)"
"0",""
"0",""
"0","pm25.map"
